<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 9.0.0rc2" />
<title>NGCGUI</title>
<link rel="stylesheet" href="..//asciidoc.css" type="text/css" />


<link rel="stylesheet" href="..//linuxcnc.css" type="text/css" />
<script type="text/javascript" src="..//asciidoc.js"></script>
<script type="text/javascript">
/*<![CDATA[*/
asciidoc.install(2);
/*]]>*/
</script>
</head>
<body class="book">
<div id="header">
<h1>NGCGUI</h1>
<div id="toc">
  <div id="toctitle">Table of Contents</div>
  <noscript><p><b>JavaScript must be enabled in your browser to display the table of contents.</b></p></noscript>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="imageblock" id="cha:ngcgui" style="text-align:center;">
<div class="content">
<figure>
<img src="images/ngcgui.png" alt="images/ngcgui.png"/>
<figcaption class="title"> Figure 1. NGCGUI embedded into AXIS</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_overview">1. Overview</h2>
<div class="sectionbody">
<div class="ulist"><ul>
<li>
<p>
<em>NGCGUI</em> is a Tcl application to work with subroutines. It allows you to
  have a conversational interface with LinuxCNC. You can organize the
  subroutines in the order you need them to run and concatenate the
  subroutines into one file for a complete part program.
</p>
</li>
<li>
<p>
<em>NGCGUI</em> can run as a standalone application or can be embedded in
  multiple tab pages in the AXIS GUI.
</p>
</li>
<li>
<p>
<em>PyNGCGUI</em> is an alternate, Python implementation of NGCGUI.
</p>
</li>
<li>
<p>
<em>PyNGCGUI</em> can run as a standalone application or can be embedded as
  a tab page (with its own set of multiple subroutine tabs) in any
  GUI that supports embedding of GladeVCP applications AXIS, Touchy, Gscreen
  and GMOCCAPY.
</p>
</li>
</ul></div>
<div class="paragraph"><p>Using NGCGUI or PyNGCGUI:</p></div>
<div class="ulist"><ul>
<li>
<p>
Tab pages are provided for each subroutine specified in the INI file.
</p>
</li>
<li>
<p>
New subroutines tab pages can be added on the fly using the
  <a href="ngcgui.html#ngcgui-ini">custom tab</a>.
</p>
</li>
<li>
<p>
Each subroutine tab page provides entry boxes for all subroutine parameters.
</p>
</li>
<li>
<p>
The entry boxes can have a default value and an label that
  are identified by special comments in the subroutine file.
</p>
</li>
<li>
<p>
Subroutine invocations can be concatenated together to form a multiple step
  program.
</p>
</li>
<li>
<p>
Any single-file G-code subroutine that conforms to NGCGUI conventions can be used.
</p>
</li>
<li>
<p>
Any gcmc (G-code-meta-compiler) program that conforms to NGCGUI conventions
  for tagging variables can be used. (The gcmc executable must be installed
  separately, see: <a href="https://www.vagrearg.org/content/gcmc">https://www.vagrearg.org/content/gcmc</a>)
</p>
</li>
</ul></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph"><p>NGCGUI and PyNGCGUI implement the same functions and both process .ngc and .gcmc
files that conform to a few NGCGUI-specific conventions.  In this document,
the term <em>NGCGUI</em> generally refers to either application.</p></div>
</td>
</tr></table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_demonstration_configurations">2. Demonstration Configurations</h2>
<div class="sectionbody">
<div class="paragraph"><p>A number of demonstration configurations are located in the sim directory
of the Sample Configurations offered by the LinuxCNC configuration picker. The
configuration picker is on the system&#8217;s main menu: Applications &gt; CNC &gt; LinuxCNC</p></div>
<div class="paragraph"><p>Examples are included for the AXIS, Touchy, gscreen, and GMOCCAPY.
These examples demonstrate both 3-axis (XYZ) cartesian configurations
(like mills) and lathe (XZ) setups.  Some examples show the use of a
pop up keyboard for touch screen systems and other examples demonstrate
the use of files created for the gcmc (G-code Meta Compiler) application.
The touchy examples also demonstrate incorporation of a GladeVCP back plot
viewer (gremlin_view).</p></div>
<div class="paragraph"><p>The simplest application is found as:</p></div>
<div class="literalblock">
<div class="content">
<pre><code>Sample Configurations/sim/axis/ngcgui/ngcgui_simple</code></pre>
</div></div>
<div class="paragraph"><p>A comprehensive example showing gcmc compatibility is at:</p></div>
<div class="literalblock">
<div class="content">
<pre><code>Sample Configurations/sim/axis/ngcgui/ngcgui_gcmc</code></pre>
</div></div>
<div class="paragraph"><p>A comprehensive example embedded as a GladeVCP app and using gcmc is at:</p></div>
<div class="literalblock">
<div class="content">
<pre><code>Sample Configurations/sim/gscreen/ngcgui/pyngcgui_gcmc</code></pre>
</div></div>
<div class="paragraph"><p>The example sim configurations make use of library files that provide
example G-code subroutine (.ngc) files and G-code-meta-compiler (.gcmc) files:</p></div>
<div class="ulist"><ul>
<li>
<p>
<em>nc_files/ngcgui_lib</em>
</p>
<div class="ulist"><ul>
<li>
<p>
<em>ngcgui.ngc</em> - An easy to understand example using subroutines
</p>
</li>
<li>
<p>
<em>arc1.ngc</em> - basic arc using cutter radius compensation
</p>
</li>
<li>
<p>
<em>arc2.ngc</em> - arc speced by center, offset, width, angle (calls arc1)
</p>
</li>
<li>
<p>
<em>backlash.ngc</em> - routine to measure an axis backlash with dial indicator
</p>
</li>
<li>
<p>
<em>db25.ngc</em> - creates a DB25 plug cutout
</p>
</li>
<li>
<p>
<em>gosper.ngc</em> - a recursion demo (flowsnake)
</p>
</li>
<li>
<p>
<em>helix.ngc</em> - helix or D-hole cutting
</p>
</li>
<li>
<p>
<em>helix_rtheta.ngc</em> - helix or D-hole positioned by radius and angle
</p>
</li>
<li>
<p>
<em>hole_circle.ngc</em> - equally spaced holes on a circle
</p>
</li>
<li>
<p>
<em>ihex.ngc</em> - internal hexagon
</p>
</li>
<li>
<p>
<em>iquad.ngc</em> - internal quadrilateral
</p>
</li>
<li>
<p>
<em>ohex.ngc</em> - outside hexagon
</p>
</li>
<li>
<p>
<em>oquad.ngc</em> - outside quadrilateral
</p>
</li>
<li>
<p>
<em>qpex_mm.ngc</em> - demo of qpockets (mm based)
</p>
</li>
<li>
<p>
<em>qpex.ngc</em> - demo of qpockets (inch based)
</p>
</li>
<li>
<p>
<em>qpocket.ngc</em> - quadrilateral pocket
</p>
</li>
<li>
<p>
<em>rectangle_probe.ngc</em> - probe a rectangular area
</p>
</li>
<li>
<p>
<em>simp.ngc</em> - a simple subroutine example that creates two circles
</p>
</li>
<li>
<p>
<em>slot.ngc</em> - slot from connecting two endpoints
</p>
</li>
<li>
<p>
<em>xyz.ngc</em> - machine exerciser constrained to a box shape
</p>
</li>
<li>
<p>
<em>Custom</em> - Creates custom tabs
</p>
</li>
<li>
<p>
<em>ttt</em> - True Type Tracer, to create texts to be engraved
</p>
</li>
</ul></div>
</li>
<li>
<p>
<em>nc_files/ngcgui_lib/lathe</em>
</p>
<div class="ulist"><ul>
<li>
<p>
<em>ngcgui-lathe</em> - Example lathe subroutine
</p>
</li>
<li>
<p>
<em>g76base.ngc</em> - GUI for G76 threading
</p>
</li>
<li>
<p>
<em>g76diam.ngc</em> - threading speced by major, minor diameters
</p>
</li>
<li>
<p>
<em>id.ngc</em> - bores the inside diameter
</p>
</li>
<li>
<p>
<em>od.ngc</em> - turns the outside diameter
</p>
</li>
<li>
<p>
<em>taper-od.ngc</em> - turns a taper on the outside diameter
</p>
</li>
<li>
<p>
<em>Custom</em> - Creates custom tabs
</p>
</li>
</ul></div>
</li>
<li>
<p>
<em>nc_files/gcmc_lib</em>
</p>
<div class="ulist"><ul>
<li>
<p>
<em>drill.gcmc</em> - drill holes in rectangle pattern
</p>
</li>
<li>
<p>
<em>square.gcmc</em> - simple demo of variable tags for gcmc files
</p>
</li>
<li>
<p>
<em>star.gcmc</em> - gcmc demo illustrating functions and arrays
</p>
</li>
<li>
<p>
<em>wheels.gcmc</em> - gcmc demo of complex patterns
</p>
</li>
</ul></div>
</li>
</ul></div>
<div class="paragraph"><p>To try a demonstration, select a sim configuration and start
the LinuxCNC program.</p></div>
<div class="paragraph"><p>If using the AXIS GUI, press the <em>E-Stop</em>
<span class="image">
<img src="images/tool_estop.png" alt="images/tool_estop.png" />
</span> then <em>Machine Power</em>
<span class="image">
<img src="images/tool_power.png" alt="images/tool_power.png" />
</span> then <em>Home All</em>. Pick a NGCGUI tab, fill in
any empty blanks with sensible values and press
<em>Create Feature</em> then <em>Finalize</em>. Finally  press the <em>Run</em>
<span class="image">
<img src="images/tool_run.png" alt="images/tool_run.png" />
</span> button to watch it run. Experiment
by creating multiple features and features from different tab pages.</p></div>
<div class="paragraph"><p>To create several subroutines concatenated into a single file, go to each tab
fill in the blanks, press <em>Create Feature</em> then using the arrow keys move any
tabs needed to put them in order. Now press <em>Finalize</em> and answer the prompt
to create</p></div>
<div class="paragraph"><p>Other GUIs will have similar functionality but the buttons and names
may be different.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph"><p>The demonstration configs create tab pages for just a few of the provided
examples. Any GUI with a <a href="ngcgui.html#ngcgui-ini">custom tab</a> can open any of the library
example subroutines or any user file if it is in the LinuxCNC subroutine
path.</p></div>
<div class="paragraph"><p>To see special key bindings, click inside an NGCGUI tab page to get
focus and then press Control-k.</p></div>
<div class="paragraph"><p>The demonstration subroutines should run on the simulated
machine configurations included in the distribution.  A user
should always understand the behavior and purpose of a program
before running on a real machine.</p></div>
</td>
</tr></table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_library_locations">3. Library Locations</h2>
<div class="sectionbody">
<div class="paragraph"><p>In LinuxCNC installations installed from deb packages, the simulation configs
for NGCGUI use symbolic links to non-user-writable LinuxCNC libraries for:</p></div>
<div class="ulist"><ul>
<li>
<p>
<em>nc_files/ngcgui_lib</em>             NGCGUI-compatible subfiles
</p>
</li>
<li>
<p>
<em>nc_files/ngcgui_lib/lathe</em>       NGCGUI-compatible lathe subfiles
</p>
</li>
<li>
<p>
<em>nc_files/gcmc_lib</em>               NGCGUI-gcmc-compatible programs
</p>
</li>
<li>
<p>
<em>nc_files/ngcgui_lib/utilitysubs</em> Helper subroutines
</p>
</li>
<li>
<p>
<em>nc_files/ngcgui_lib/mfiles</em>      User M files
</p>
</li>
</ul></div>
<div class="paragraph"><p>These libraries are located by INI file items that specify the search
paths used by LinuxCNC (and NGCGUI):</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.9
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #000000">[RS274NGC]</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">SUBROUTINE_PATH </span></span><span style="font-weight: bold"><span style="color: #000000">=</span></span><span style="color: #009900"> ../../nc_files/ngcgui_lib:../../nc_files/gcmc_lib:../../nc_files/ngcgui_lib/utilitysubs</span>
<span style="font-weight: bold"><span style="color: #0000FF">USER_M_PATH     </span></span><span style="font-weight: bold"><span style="color: #000000">=</span></span><span style="color: #009900"> ../../nc_files/ngcgui_lib/mfiles</span></tt></pre></div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph"><p>These are long lines (not continued on multiple lines)
that specify the directories used in a search patch.  The
directory names are separated by colons (:). No spaces should
occur between directory names.</p></div>
</td>
</tr></table>
</div>
<div class="paragraph"><p>A user can create new directories for their own subroutines and
M-files and add them to the search path(s).</p></div>
<div class="paragraph"><p>For example, a user could create directories from the terminal with the commands:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>mkdir /home/myusername/mysubs
mkdir /home/myusername/mymfiles</code></pre>
</div></div>
<div class="paragraph"><p>And then create or copy system-provided files to these user-writable directories.
For instance, a user might create a NGCGUI-compatible subfile named:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>/home/myusername/mysubs/example.ngc</code></pre>
</div></div>
<div class="paragraph"><p>To use files in new directories, the INI file must be edited to include the new
subfiles and to augment the search path(s).  For this example:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.9
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #000000">[RS274NGC]</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">...</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">SUBROUTINE_PATH </span></span><span style="font-weight: bold"><span style="color: #000000">=</span></span><span style="color: #009900"> /home/myusername/mysubs:../../nc_files/ngcgui_lib:../../nc_files/gcmc_lib:../../nc_files/ngcgui_lib/utilitysubs</span>
<span style="font-weight: bold"><span style="color: #0000FF">USER_M_PATH     </span></span><span style="font-weight: bold"><span style="color: #000000">=</span></span><span style="color: #009900"> /home/myusername/mymfiles:../../nc_files/ngcgui_lib/mfiles</span>

<span style="font-weight: bold"><span style="color: #000000">[DISPLAY]</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">...</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">NGCGUI_SUBFILE </span></span><span style="font-weight: bold"><span style="color: #000000">=</span></span><span style="color: #009900"> example.ngc</span>
<span style="font-weight: bold"><span style="color: #0000FF">...</span></span></tt></pre></div></div>
<div class="paragraph"><p>LinuxCNC (and NGCGUI) use the first file found when searching
directories in the search path.  With this behavior, you can
supersede an ngcgui_lib subfile by placing a subfile with an
identical name in a directory that is found earlier in the path
search. More information can be found in the INI chapter of the
Integrators Manual.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_standalone_usage">4. Standalone Usage</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_standalone_ngcgui">4.1. Standalone NGCGUI</h3>
<div class="paragraph"><p>For usage, type in a terminal:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>ngcgui --help
Usage:
  ngcgui --help | -?
  ngcgui [Options] -D &lt;nc files directory name&gt;
  ngcgui [Options] -i &lt;LinuxCNC INI file name&gt;
  ngcgui [Options]

Options:
  [-S subroutine_file]
  [-p preamble_file]
  [-P postamble_file]
  [-o output_file]
  [-a autosend_file]            (autosend to AXIS default:auto.ngc)
  [--noauto]                    (no autosend to AXIS)
  [-N | --nom2]                 (no m2 terminator (use %))
  [--font [big|small|fontspec]] (default: "Helvetica -10 normal")
  [--horiz|--vert]              (default: --horiz)
  [--cwidth comment_width]      (width of comment field)
  [--vwidth varname_width]      (width of varname field)
  [--quiet]                     (fewer comments in outfile)
  [--noiframe]                  (default: frame displays image)</code></pre>
</div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph"><p>As a standalone application, NGCGUI handles a single subroutine file which
can be invoked multiple times.  Multiple standalone NGCGUI applications
can be started independently.</p></div>
</td>
</tr></table>
</div>
</div>
<div class="sect2">
<h3 id="_standalone_pyngcgui">4.2. Standalone PyNGCGUI</h3>
<div class="paragraph"><p>For usage, type in a terminal:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>pyngcgui --help
Usage:
pyngcgui [Options] [&lt;sub_filename&gt;]
Options requiring values:
    [-d | --demo] [0|1|2] (0: DEMO standalone toplevel)
                          (1: DEMO embed new notebook)
                          (2: DEMO embed within existing notebook)
    [-S | --subfile       &lt;sub file name&gt;]
    [-p | --preamble      &lt;preamble file name&gt;]
    [-P | --postamble     &lt;postamble file name&gt;]
    [-i | --ini           &lt;INI file name&gt;]
    [-a | --autofile      &lt;auto file name&gt;]
    [-t | --test          &lt;testno&gt;]
    [-K | --keyboardfile  &lt;glade_file&gt;] (use custom popupkeyboard glade file)
Solo Options:
    [-v | --verbose]
    [-D | --debug]
    [-N | --nom2]         (no m2 terminator (use %))
    [-n | --noauto]       (save but do not automatically send result)
    [-k | --keyboard]     (use default popupkeybaord)
    [-s | --sendtoaxis]   (send generated NGC file to AXIS GUI)
Notes:
      A set of files is comprised of a preamble, subfile, postamble.
      The preamble and postamble are optional.
      One set of files can be specified from cmdline.
      Multiple sets of files can be specified from an INI file.
      If --ini is NOT specified:
         search for a running LinuxCNC and use its INI file.</code></pre>
</div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph"><p>As a standalone application, PyNGCGUI can read an INI file (or a
running LinuxCNC application) to create tab pages for multiple
subfiles.</p></div>
</td>
</tr></table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_embedding_ngcgui">5. Embedding NGCGUI</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_embedding_ngcgui_in_axis">5.1. Embedding NGCGUI in AXIS</h3>
<div class="paragraph"><p>The following INI file items go in the [DISPLAY] section. (See additional
sections below for additional items needed)</p></div>
<div class="ulist"><ul>
<li>
<p>
<em>TKPKG = Ngcgui 1.0</em> - the NGCGUI package
</p>
</li>
<li>
<p>
<em>TKPKG = Ngcguittt 1.0</em> - the True Type Tracer package for generating text
  for engraving (optional, must follow TKPKG = Ngcgui).
</p>
</li>
<li>
<p>
<em>NGCGUI_FONT = Helvetica -12 normal</em> - Sets the font used
</p>
</li>
<li>
<p>
<em>NGCGUI_PREAMBLE = in_std.ngc</em> - The preamble file to be added at the
  beginning of the subroutine. When several subroutines are concatenated,
  it is only added once.
</p>
</li>
<li>
<p>
<em>NGCGUI_SUBFILE = simp.ngc</em> - Creates a tab from the named subroutine.
</p>
</li>
<li>
<p>
<em>NGCGUI_SUBFILE = ""</em> - Creates a custom tab
</p>
</li>
<li>
<p>
<em>#NGCGUI_OPTIONS = opt1 opt2 &#8230;</em> - NGCGUI options:
</p>
<div class="ulist"><ul>
<li>
<p>
<em>nonew</em>   &#8201;&#8212;&#8201;Prohibits creation of new custom tab
</p>
</li>
<li>
<p>
<em>noremove</em>&#8201;&#8212;&#8201;Prohibits deleting a tab page
</p>
</li>
<li>
<p>
<em>noauto</em>  &#8201;&#8212;&#8201;Do not run automatically (makeFile, then manual run)
</p>
</li>
<li>
<p>
<em>noiframe</em>&#8201;&#8212;&#8201;No internal image, image on separate top level
</p>
</li>
</ul></div>
</li>
<li>
<p>
<em>TTT = truetype-tracer</em> - name of the truetype tracer program (it must be in user PATH)
</p>
</li>
<li>
<p>
<em>TTT_PREAMBLE = in_std.ngc</em> - Optional, specifies filename for preamble used for
  ttt created subfiles. (alternate: mm_std.ngc)
</p>
</li>
</ul></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph"><p>The optional truetype tracer items are used to specify an NGCGUI-compatible tab page
that uses the application truetype-tracer.  The truetype-tracer application must
be installed independently and located in the user PATH.</p></div>
</td>
</tr></table>
</div>
</div>
<div class="sect2">
<h3 id="_embedding_pyngcgui_as_a_gladevcp_tab_page_in_a_gui">5.2. Embedding PyNGCGUI as a GladeVCP tab page in a GUI</h3>
<div class="paragraph"><p>The following INI file items go in the [DISPLAY] section for use with the
AXIS, Gscreen, or Touchy GUIs.  (See additional sections below for additional
items needed)</p></div>
<div class="ulist"><div class="title">EMBED_ Items</div><ul>
<li>
<p>
<code>EMBED_TAB_NAME = PyNGCGUI</code> - name to appear on embedded tab
</p>
</li>
<li>
<p>
<code>EMBED_TAB_COMMAND = gladevcp -x {XID} pyngcgui_axis.ui</code> - invokes GladeVCP
</p>
</li>
<li>
<p>
<code>EMBED_TAB_LOCATION = name_of_location</code> - where the embedded page is located
</p>
</li>
</ul></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph"><p>The EMBED_TAB_LOCATION specifier is not used for the AXIS GUI.  While
PyNGCGUI can be embedded in AXIS, integration is more complete when using
NGCGUI (using TKPKG = Ngcgui 1.0).  To specify the EMBED_TAB_LOCATION
for other GUIs, see the <a href="../config/ini-config.html#sub:ini:sec:display">DISPLAY Section</a> of the INI
Configuration Chapter.</p></div>
</td>
</tr></table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph"><p>The truetype tracer GUI front-end is not currently available for GladeVCP
applications.</p></div>
</td>
</tr></table>
</div>
</div>
<div class="sect2">
<h3 id="ngcgui-ini">5.3. Additional INI File items required for NCGUI or PyNGCGUI</h3>
<div class="paragraph"><p>The following INI file items go in the [DISPLAY] section for any GUI
that embeds either NGCGUI or PyNGCGUI.</p></div>
<div class="ulist"><ul>
<li>
<p>
<em>NGCGUI_FONT = Helvetica -12 normal</em> - specifies the font name,size, normal|bold
</p>
</li>
<li>
<p>
<em>NGCGUI_PREAMBLE = in_std.ngc</em> - the preamble file to be added in front of the
  subroutines. When concatenating several common subroutine invocations, this preamble
  is only added once.  For mm-based machines, use mm_std.ngc
</p>
</li>
<li>
<p>
<em>NGCGUI_SUBFILE = filename1.ngc</em> - creates a tab from the filename1 subroutine
</p>
</li>
<li>
<p>
<em>NGCGUI_SUBFILE = filename2.ngc</em> - creates a tab from the filename2 subroutine
</p>
</li>
<li>
<p>
<em>&#8230; etc.</em>
</p>
</li>
<li>
<p>
<em>NGCGUI_SUBFILE = gcmcname1.gcmc</em> - creates a tab from the gcmcname1 file
</p>
</li>
<li>
<p>
<em>NGCGUI_SUBFILE = gcmcname2.gcmc</em> - creates a tab from the gcmcname2 file
</p>
</li>
<li>
<p>
<em>&#8230; etc.</em>
</p>
</li>
<li>
<p>
<em>NGCGUI_SUBFILE = ""</em> - creates a custom tab that can open any subroutine in the search path
</p>
</li>
<li>
<p>
<em>NGCGUI_OPTIONS = opt1 opt2 &#8230;</em> - NGCGUI options
</p>
<div class="ulist"><ul>
<li>
<p>
<em>nonew</em> - disallow making a new custom tab
</p>
</li>
<li>
<p>
<em>noremove</em> - disallow removing any tab page
</p>
</li>
<li>
<p>
<em>noauto</em> - no autosend (use makeFile, then save or manually send)
</p>
</li>
<li>
<p>
<em>noiframe</em> - no internal image, display images on separate top level widget
</p>
</li>
<li>
<p>
<em>nom2</em> - do not terminate with m2, use % terminator.  This option eliminates all
   the side effects of m2 termination
</p>
</li>
</ul></div>
</li>
<li>
<p>
<em>GCMC_INCLUDE_PATH = dirname1:dirname2</em> - search directories for gcmc include files
</p>
</li>
</ul></div>
<div class="paragraph"><p>This is an example of embedding NGCGUI into AXIS. The subroutines need to be
in a directory specified by the [RS274NGC]SUBROUTINE_PATH.  Some example
subroutines use other subroutines so check to be sure you have the
dependences, if any, in a SUBROUTINE_PATH directory.  Some subroutines may
use custom M-files which must be in a directory specified by the
[RS274NGC]USER_M_PATH.</p></div>
<div class="paragraph"><p>The G-code-meta-compiler (gcmc) can include statements like:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>include("filename.inc.gcmc");</code></pre>
</div></div>
<div class="paragraph"><p>By default, gcmc includes the current directory which, for LinuxCNC, will be
the directory containing the LinuxCNC INI file. Additional directories can be
prepended to the gcmc search order with the GCMC_INCLUDE_PATH item.</p></div>
<div class="listingblock">
<div class="title">Sample AXIS-GUI-based INI</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.9
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #000000">[RS274NGC]</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">...</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">SUBROUTINE_PATH   </span></span><span style="font-weight: bold"><span style="color: #000000">=</span></span><span style="color: #009900"> ../../nc_files/ngcgui_lib:../../ngcgui_lib/utilitysubs</span>
<span style="font-weight: bold"><span style="color: #0000FF">USER_M_PATH       </span></span><span style="font-weight: bold"><span style="color: #000000">=</span></span><span style="color: #009900"> ../../nc_files/ngcgui_lib/mfiles</span>

<span style="font-weight: bold"><span style="color: #000000">[DISPLAY]</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">TKPKG             </span></span><span style="font-weight: bold"><span style="color: #000000">=</span></span><span style="color: #009900"> Ngcgui    1.0</span>
<span style="font-weight: bold"><span style="color: #0000FF">TKPKG             </span></span><span style="font-weight: bold"><span style="color: #000000">=</span></span><span style="color: #009900"> Ngcguittt 1.0</span>
<span style="font-style: italic"><span style="color: #9A1900"># Ngcgui must precede Ngcguittt</span></span>

<span style="font-weight: bold"><span style="color: #0000FF">NGCGUI_FONT       </span></span><span style="font-weight: bold"><span style="color: #000000">=</span></span><span style="color: #009900"> Helvetica -12 normal</span>
<span style="font-style: italic"><span style="color: #9A1900"># specify filenames only, files must be in [RS274NGC]SUBROUTINE_PATH</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">NGCGUI_PREAMBLE   </span></span><span style="font-weight: bold"><span style="color: #000000">=</span></span><span style="color: #009900"> in_std.ngc</span>
<span style="font-weight: bold"><span style="color: #0000FF">NGCGUI_SUBFILE    </span></span><span style="font-weight: bold"><span style="color: #000000">=</span></span><span style="color: #009900"> simp.ngc</span>
<span style="font-weight: bold"><span style="color: #0000FF">NGCGUI_SUBFILE    </span></span><span style="font-weight: bold"><span style="color: #000000">=</span></span><span style="color: #009900"> xyz.ngc</span>
<span style="font-weight: bold"><span style="color: #0000FF">NGCGUI_SUBFILE    </span></span><span style="font-weight: bold"><span style="color: #000000">=</span></span><span style="color: #009900"> iquad.ngc</span>
<span style="font-weight: bold"><span style="color: #0000FF">NGCGUI_SUBFILE    </span></span><span style="font-weight: bold"><span style="color: #000000">=</span></span><span style="color: #009900"> db25.ngc</span>
<span style="font-weight: bold"><span style="color: #0000FF">NGCGUI_SUBFILE    </span></span><span style="font-weight: bold"><span style="color: #000000">=</span></span><span style="color: #009900"> ihex.ngc</span>
<span style="font-weight: bold"><span style="color: #0000FF">NGCGUI_SUBFILE    </span></span><span style="font-weight: bold"><span style="color: #000000">=</span></span><span style="color: #009900"> gosper.ngc</span>
<span style="font-style: italic"><span style="color: #9A1900"># specify "" for a custom tab page</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">NGCGUI_SUBFILE    </span></span><span style="font-weight: bold"><span style="color: #000000">=</span></span><span style="color: #009900"> ""</span>
<span style="font-style: italic"><span style="color: #9A1900">#NGCGUI_SUBFILE   = "" use when image frame is specified if</span></span>
<span style="font-style: italic"><span style="color: #9A1900">#                      opening other files is required</span></span>
<span style="font-style: italic"><span style="color: #9A1900">#                      images will be put in a top level window</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">NGCGUI_OPTIONS    </span></span><span style="font-weight: bold"><span style="color: #000000">=</span></span>
<span style="font-style: italic"><span style="color: #9A1900">#NGCGUI_OPTIONS   = opt1 opt2 ...</span></span>
<span style="font-style: italic"><span style="color: #9A1900"># opt items:</span></span>
<span style="font-style: italic"><span style="color: #9A1900">#   nonew      -- disallow making a new custom tab</span></span>
<span style="font-style: italic"><span style="color: #9A1900">#   noremove   -- disallow removing any tab page</span></span>
<span style="font-style: italic"><span style="color: #9A1900">#   noauto     -- no auto send (makeFile, then manually send)</span></span>
<span style="font-style: italic"><span style="color: #9A1900">#   noiframe   -- no internal image, image on separate top level</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">GCMC_INCLUDE_PATH </span></span><span style="font-weight: bold"><span style="color: #000000">=</span></span><span style="color: #009900"> /home/myname/gcmc_includes</span>

<span style="font-weight: bold"><span style="color: #0000FF">TTT               </span></span><span style="font-weight: bold"><span style="color: #000000">=</span></span><span style="color: #009900"> truetype-tracer</span>
<span style="font-weight: bold"><span style="color: #0000FF">TTT_PREAMBLE      </span></span><span style="font-weight: bold"><span style="color: #000000">=</span></span><span style="color: #009900"> in_std.ngc</span>

<span style="font-weight: bold"><span style="color: #0000FF">PROGRAM_PREFIX    </span></span><span style="font-weight: bold"><span style="color: #000000">=</span></span><span style="color: #009900"> ../../nc_files</span></tt></pre></div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph"><p>The above is not a complete AXIS GUI INI&#8201;&#8212;&#8201;the items show are those
used by NGCGUI.  Many additional items are required by LinuxCNC to have
a complete INI file.</p></div>
</td>
</tr></table>
</div>
</div>
<div class="sect2">
<h3 id="_truetype_tracer">5.4. Truetype Tracer</h3>
<div class="paragraph"><p>Ngcgui_ttt provides support for truetype-tracer (v4).  It creates an AXIS tab
page which allows a user to create a new NGCGUI tab page after entering text
and selecting a font and other parameters.  (Truetype-tracer must be installed
independently).</p></div>
<div class="paragraph"><p>To embed ngcgui_ttt in AXIS, specify the following items in addition to NGCGUI
items:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>Item:    [DISPLAY]TKPKG = Ngcgui_ttt version_number
Example: [DISPLAY]TKPKG = Ngcgui_ttt 1.0
Note:    Mandatory, specifies loading of ngcgui_ttt in an AXIS tab page named ttt.
         Must follow the TKPKG = Ngcgui item.

Item:    [DISPLAY]TTT = path_to_truetype-tracer
Example: [DISPLAY]TTT = truetype-tracer
Note:    Optional, if not specified, attempt to use /usr/local/bin/truetype-tracer.
         Specify with absolute pathname or as a simple executable name,
         in which case the user PATH environment will used to find the program.

Item:    [DISPLAY]TTT_PREAMBLE = preamble_filename
Example: [DISPLAY]TTT_PREAMBLE = in_std.ngc
Note:    Optional, specifies filename for preamble used for ttt created subfiles.</code></pre>
</div></div>
</div>
<div class="sect2">
<h3 id="_ini_file_path_specifications">5.5. INI File Path Specifications</h3>
<div class="paragraph"><p>NGCGUI uses the LinuxCNC search path to find files.
The search path begins with the standard directory specified by:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.9
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #000000">[DISPLAY]PROGRAM_PREFIX = directory_name</span></span></tt></pre></div></div>
<div class="paragraph"><p>followed by multiple directories specified by:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.9
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #000000">[RS274NGC]SUBROUTINE_PATH = directory1_name:directory1_name:directory3_name ...</span></span></tt></pre></div></div>
<div class="paragraph"><div class="title">Directories</div><p>Directories may be specified as absolute paths or relative paths.</p></div>
<div class="ulist"><ul>
<li>
<p>
Example: <code>[DISPLAY]PROGRAM_PREFIX = /home/myname/linuxcnc/nc_files</code>
</p>
</li>
<li>
<p>
Example: <code>[DISPLAY]PROGRAM_PREFIX = ~/linuxcnc/nc_files</code>
</p>
</li>
<li>
<p>
Example: <code>[DISPLAY]PROGRAM_PREFIX = ../../nc_files</code>
</p>
</li>
</ul></div>
<div class="paragraph"><div class="title">Absolute Paths</div><p>An absolute path beginning with a "/" specifies a complete filesystem
location.  A path beginning with a "~/" specifies a path starting
from the user&#8217;s home directory.  A path beginning with "~username/"
specifies a path starting in username&#8217;s home directory.</p></div>
<div class="paragraph"><div class="title">Relative Paths</div><p>Relative paths are based on the startup directory which is the directory containing the INI file.
Using relative paths can facilitate relocation of configurations but requires a good understanding of Linux path specifiers.</p></div>
<div class="ulist"><ul>
<li>
<p>
<code>./d0</code>        is the same as d0, e.g., a directory named d0 in the startup directory
</p>
</li>
<li>
<p>
<code>../d1</code>       refers to a directory d1 in the parent directory
</p>
</li>
<li>
<p>
<code>../../d2</code>    refers to a directory d2 in the parent of the parent directory
</p>
</li>
<li>
<p>
<code>../../../d3</code> etc.
</p>
</li>
</ul></div>
<div class="paragraph"><p>Multiple directories can be specified with [RS274NGC]SUBROUTINE_PATH by separating them with colons.
The following example illustrates the format for multiple directories and shows the use of relative and absolute paths.</p></div>
<div class="listingblock">
<div class="title">Multiple Directories Example:</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.9
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #000000">[RS274NGC]SUBROUTINE_PATH = ../../nc_files/ngcgui_lib:../../nc_files/ngcgui_lib/utilitysubs:/tmp/tmpngc</span></span></tt></pre></div></div>
<div class="paragraph"><p>This is one long line, do not continue on multiple lines.
When LinuxCNC and/or NGCGUI searches for files, the first file found in the search is used.</p></div>
<div class="paragraph"><p>LinuxCNC (and NGCGUI) must be able to find all subroutines including helper routines that are called from within NGCGUI subfiles.
It is convenient to place utility subs in a separate directory as indicated in the example above.</p></div>
<div class="paragraph"><p>The distribution includes the ngcgui_lib directory and demo files for preambles, subfiles, postambles and helper files.
To modify the behavior of the files, you can copy any file and place it in an earlier part of the search path.
The first directory searched is [DISPLAY]PROGRAM_PREFIX.
You can use this directory but it is better practice to create dedicated directory(ies) and put them at the beginning of the [RS274NGC]SUBROUTINE_PATH.</p></div>
<div class="paragraph"><p>In the following example, files in /home/myname/linuxcnc/mysubs will be found before files in ../../nc_files/ngcgui_lib.</p></div>
<div class="listingblock">
<div class="title">Adding User Directory Example:</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.9
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #000000">[RS274NGC]SUBROUTINE_PATH = /home/myname/linuxcnc/mysubs:../../nc_files/ngcgui_lib:../../nc_files/ngcgui_lib/utilitysubs`</span></span></tt></pre></div></div>
<div class="paragraph"><p>New users may inadvertently try to use files that are not structured to be compatible with NGCGUI requirements.
NGCGUI will likely report numerous errors if the files are not coded per its conventions.
Good practice suggests that NGCGUI-compatible subfiles should be placed in a directory dedicated to that,purpose
and that preamble, postamble, and helper files should be in separate directory(ies) to discourage attempts to use them as subfiles.
Files not intended for use as subfiles can include a special comment: "(not_a_subfile)" so that NGCGUI will reject them automatically with a relevant message.</p></div>
</div>
<div class="sect2">
<h3 id="_summary_of_ini_file_item_details_for_ngcgui_usage">5.6. Summary of INI File item details for NGCGUI usage</h3>
<div class="dlist"><dl>
<dt class="hdlist1">
[RS274NGC]SUBROUTINE_PATH = dirname1:dirname2:dirname3 &#8230;
</dt>
<dd>
<p>
  <em>Example</em>: <code>[RS274NGC]SUBROUTINE_PATH = ../../nc_files/ngcgui_lib:../../nc_files/ngcgui_lib/utilitysubs</code><br />
  <em>Note</em>:    Optional, but very useful to organize subfiles and utility files.
</p>
</dd>
<dt class="hdlist1">
[RS274NGC]USER_M_PATH = dirname1:dirname2:dirname3 &#8230;
</dt>
<dd>
<p>
  <em>Example</em>: <code>[RS274NGC]USER_M_PATH = ../../nc_files/ngcgui_lib/mfiles</code><br />
  <em>Note</em>:    Optional, needed to locate custom user M-files.
</p>
</dd>
<dt class="hdlist1">
[DISPLAY]EMBED_TAB_NAME = name to display on embedded tab page
</dt>
<dd>
<p>
  <em>Example</em>: <code>[DISPLAY]EMBED_TAB_NAME = Pyngcgui</code><br />
  <em>Note</em>:    The entries: <code>EMBED_TAB_NAME</code>, <code>EMBED_TAB_COMMAND</code>, <code>EMBED_TAB_LOCATION</code>
             define an embedded application for several LinuxCNC GUIs.
</p>
</dd>
<dt class="hdlist1">
[DISPLAY]EMBED_TAB_COMMAND = programname followed by arguments
</dt>
<dd>
<p>
  <em>Example</em>: <code>[DISPLAY]EMBED_TAB_COMMAND = gladevcp -x {XID} pyngcgui_axis.ui</code><br />
  <em>Note</em>:    For GladeVCP applications, see the <a href="gladevcp.html#cha:glade-vcp">GladeVCP Chapter</a>.
</p>
</dd>
<dt class="hdlist1">
[DISPLAY]EMBED_TAB_LOCATION = name_of_location
</dt>
<dd>
<p>
  <em>Example</em>: <code>[DISPLAY]EMBED_TAB_LOCATION = notebook_main</code><br />
  <em>Note</em>:    See example INI files for possible locations.<br />
             Not required for the AXIS GUI.
</p>
</dd>
<dt class="hdlist1">
[DISPLAY]PROGRAM_PREFIX = dirname
</dt>
<dd>
<p>
  <em>Example</em>: <code>[DISPLAY]PROGRAM_PREFIX = ../../nc_files</code><br />
  <em>Note</em>:    Mandatory and needed for numerous LinuxCNC functions.<br />
             It is the first directory used in the search for files.
</p>
</dd>
<dt class="hdlist1">
[DISPLAY]TKPKG = NGCGUI version_number
</dt>
<dd>
<p>
  <em>Example</em>: <code>[DISPLAY]TKPKG = Ngcgui 1.0</code><br />
  <em>Note</em>:    Required only for AXIS GUI embedding.<br />
             Specifies loading of NGCGUI AXIS tab pages.
</p>
</dd>
<dt class="hdlist1">
[DISPLAY]NGCGUI_FONT = font_descriptor
</dt>
<dd>
<p>
  <em>Example</em>: [DISPLAY]NGCGUI_FONT = Helvetica -12 normal<br />
  <em>Note</em>:    Optional, font_descriptor is a tcl-compatible font specifier with items for fonttype -fontsize fontweight.<br />
             Default is: Helvetica -10 normal.<br />
             Smaller font sizes may be useful for small screens.<br />
             Larger font sizes may be helpful for touch screen applications .
</p>
</dd>
<dt class="hdlist1">
[DISPLAY]NGCGUI_SUBFILE = subfile_filename
</dt>
<dd>
<p>
  <em>Example</em>: <code>[DISPLAY]NGCGUI_SUBFILE = simp.ngc</code><br />
  <em>Example</em>: <code>[DISPLAY]NGCGUI_SUBFILE = square.gcmc</code><br />
  <em>Example</em>: <code>[DISPLAY]NGCGUI_SUBFILE = ""</code><br />
  <em>Note</em>:    Use one or more items to specify NGCGUI-compatible subfiles or gcmc programs that require a tab page on startup.<br />
             A "Custom" tab will be created when the filename is "".<br />
             A user can use a "Custom" tab to browse the file system and identify preamble, subfile, and postamble files.
</p>
</dd>
<dt class="hdlist1">
[DISPLAY]NGCGUI_PREAMBLE = preamble_filename
</dt>
<dd>
<p>
  <em>Example</em>: <code>[DISPLAY]NGCGUI_PREAMBLE = in_std.ngc</code><br />
  <em>Note</em>:    Optional, when specified, the file is prepended to a subfile.<br />
             Files created with "Custom" tab pages use the preamble specified with the page.
</p>
</dd>
<dt class="hdlist1">
[DISPLAY]NGCGUI_POSTAMBLE = postamble_filename
</dt>
<dd>
<p>
  <em>Example</em>: <code>[DISPLAY]NGCGUI_POSTAMBLE = bye.ngc</code><br />
  <em>Note</em>:    Optional, when specified, the file is appended to a subfiles.<br />
             Files created with "Custom" tab pages use the postamble specified with the page.
</p>
</dd>
<dt class="hdlist1">
[DISPLAY]NGCGUI_OPTIONS = opt1 opt2 &#8230;
</dt>
<dd>
<p>
  <em>Example</em>: [DISPLAY]NGCGUI_OPTIONS = nonew noremove<br />
  <em>Note</em>:    Multiple options are separated by blanks.<br />
             By default, NGCGUI configures tab pages so that:<br />
               1) a user can make new tabs;<br />
               2) a user can remove tabs (except for the last remaining one);<br />
               3) finalized files are automatically sent to LinuxCNC;<br />
               4) an image frame (iframe) is made available to display an image for the subfile (if an image is provided);<br />
               5) the NGCGUI result file sent to LinuxCNC is terminated with an M2 (and incurs M2 side-effects).<br />
</p>
<div class="paragraph"><p>The options <code>nonew</code>, <code>noremove</code>, <code>noauto</code>, <code>noiframe</code>, <code>nom2</code> respectively
disable these default behaviors.</p></div>
<div class="paragraph"><p>By default, if an image (.png,.gif,jpg,pgm) file is found in the same directory as the subfile, the image is displayed in the iframe.
Specifying the <code>noiframe</code> option makes available additional buttons for selecting a preamble, subfile, and postamble and additional checkboxes.
Selections of the checkboxes are always available with special keys:<br />
  <code>Ctrl-R</code> Toggle "Retain values on Subfile read",<br />
  <code>Ctrl-E</code> Toggle "Expand subroutine",<br />
  <code>Ctrl-a</code> Toggle "Autosend",<br />
  <code>Ctrl-k</code> lists all keys and functions.<br /></p></div>
<div class="paragraph"><p>If <code>noiframe</code> is specified and an image file is found, the image is displayed in a separate window and all functions are available on the tab page.
The <code>NGCGUI_OPTIONS</code> apply to all NGCGUI tabs except that the <code>nonew</code>, <code>noremove</code>, and <code>noiframe</code> options are not applicable for "Custom" tabs.
Do not use "Custom" tabs if you want to limit the user&#8217;s ability to select subfiles or create additional tab pages.</p></div>
</dd>
<dt class="hdlist1">
[DISPLAY]GCMC_INCLUDE_PATH = dirname1:dirname2:&#8230;
</dt>
<dd>
<p>
  <em>Example</em>: <code>[DISPLAY]GCMC_INCLUDE_PATH = /home/myname/gcmc_includes:/home/myname/gcmc_includes2</code><br />
  <em>Note</em>:    Optional, each directory will be included when gcmc is invoked using the option: <code>--include dirname</code>.
</p>
</dd>
</dl></div>
<p><span class="comment"> FIXME Keyboard shortcuts do not work in version _fr.</span></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_file_requirements_for_ngcgui_compatibility">6. File Requirements for NGCGUI Compatibility</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_single_file_gcode_ngc_subroutine_requirements">6.1. Single-File Gcode (.ngc) Subroutine Requirements</h3>
<div class="paragraph"><p>An NGCGUI-compatible subfile contains a single subroutine definition.
The name of the subroutine must be the same as the filename (not including the .ngc suffix).
LinuxCNC supports named or numbered subroutines, but only named subroutines are compatible with NGCGUI. For more information see the <a href="../gcode/o-code.html#cha:o-codes">O-Codes</a> chapter.</p></div>
<div class="paragraph"><p>The first non-comment line should be a <code>sub</code> statement.<br />
The last non-comment line should be a <code>endsub</code> statement.</p></div>
<div class="listingblock">
<div class="title">examp.ngc:</div>
<div class="content">
<pre><code>(info: info_text_to_appear_at_top_of_tab_page)
; comment line beginning with semicolon
( comment line using parentheses)
o&lt;examp&gt; sub
  BODY_OF_SUBROUTINE
o&lt;examp&gt; endsub
; comment line beginning with semicolon
( comment line using parentheses)</code></pre>
</div></div>
<div class="paragraph"><p>The body of the subroutine should begin with a set of statements that define local named parameters for each positional parameter expected for the subroutine call.
These definitions must be consecutive beginning with #1 and ending with the last used parameter number.
Definitions must be provided for each of these parameters (no omissions).</p></div>
<div class="listingblock">
<div class="title">Parameter Numbering</div>
<div class="content">
<pre><code>#&lt;xparm&gt; = #1
#&lt;yparm&gt; = #2
#&lt;zparm&gt; = #3</code></pre>
</div></div>
<div class="paragraph"><p>LinuxCNC considers all numbered parameters in the range #1 thru #30 to be calling parameters, so NGCGUI provides entry boxes for any occurrence of parameters in this range.
It is good practice to avoid use of numbered parameters #1 through #30 anywhere else in the subroutine.
Using local, named parameters is recommended for all internal variables.</p></div>
<div class="paragraph"><p>Each defining statement may optionally include a special comment and a default value for the parameter.</p></div>
<div class="listingblock">
<div class="title">Statement Prototype</div>
<div class="content">
<pre><code>#&lt;vname&gt; = #n (=default_value)
or
#&lt;vname&gt; = #n (comment_text)
or
#&lt;vname&gt; = #n (=default_value comment_text)</code></pre>
</div></div>
<div class="listingblock">
<div class="title">Parameter Examples</div>
<div class="content">
<pre><code>#&lt;xparm&gt; = #1 (=0.0)
#&lt;yparm&gt; = #2 (Ystart)
#&lt;zparm&gt; = #3 (=0.0 Z start setting)</code></pre>
</div></div>
<div class="paragraph"><p>If a default_value is provided, it will be entered in the entry box for the parameter on startup.
If comment_text is included, it will be used to identify the input instead of the parameter name.</p></div>
<div class="paragraph"><div class="title">Global Named Parameters</div><p>Notes on global named parameters and NGCGUI:</p></div>
<div class="paragraph"><p>(global named parameters have a leading underscore in the name, like #&lt;_someglobalname&gt;)</p></div>
<div class="paragraph"><p>As in many programming languages, use of globals is powerful but can often lead to unexpected consequences.
In LinuxCNC, existing global named parameters will be valid at subroutine execution and subroutines can modify or create global named parameters.</p></div>
<div class="paragraph"><p>Passing information to subroutines using global named parameters is discouraged
since such usage requires the establishment and maintenance of a well-defined global context that is difficult to maintain.
Using numbered parameters #1 thru #30 as subroutine inputs should be sufficient to satisfy a wide range of design requirements.</p></div>
<p><span class="comment">FIXME are input global named parameters supported or not ?</span></p>
<div class="paragraph"><p>NGCGUI supports some input global named parameter but their usage is obsolete and not documented here.</p></div>
<div class="paragraph"><p>While input global named parameters are discouraged, LinuxCNC subroutines must use global named parameters for returning results.
Since NGCGUI-compatible subfiles are aimed at GUI usage, return values are not a common requirement.
However, NGCGUI is useful as a testing tool for subroutines which do return global named parameters
and it is common for NGCGUI-compatible subfiles to call utility subroutine files that return results with global named parameters.</p></div>
<div class="paragraph"><p>To support these usages, NGCGUI ignores global named parameters that include a colon (:) character in their name.
Use of the colon (:) in the name prevents NGCGUI from making entryboxes for these parameters.</p></div>
<div class="listingblock">
<div class="title">Global Named Parameters Example</div>
<div class="content">
<pre><code>o&lt;examp&gt; sub
...
#&lt;_examp:result&gt; = #5410       (return the current tool diameter)
...
o&lt;helper&gt; call [#&lt;x1&gt;] [#&lt;x2&gt;] (call a subroutine)
#&lt;xresult&gt; = #&lt;_helper:answer&gt; (immediately localize the helper global result)
#&lt;_helper:answer&gt; = 0.0        (nullify global named parameter used by subroutine)
...
o&lt;examp&gt; endsub</code></pre>
</div></div>
<div class="paragraph"><p>In the above example, the utility subroutine will be found in a separate file named helper.ngc.
The helper routine returns a result in a global named parameter named #&lt;_helper:answer.</p></div>
<div class="paragraph"><p>For good practice, the calling subfile immediately localizes the result for use elsewhere in the subfile
and the global named parameter used for returning the result is nullified in an attempt to mitigate its inadvertent use elsewhere in the global context.
A nullification value of 0.0 may not always be a good choice.</p></div>
<div class="paragraph"><p>NGCGUI supports the creation and concatenation of multiple features for a subfile and for multiple subfiles.
It is sometimes useful for subfiles to determine their order at runtime, so NGCGUI inserts a special global parameter that can be tested within subroutines.
The parameter is named #&lt;_feature:&gt;.
Its value begins with a value of 0 and is incremented for each added feature.</p></div>
<div class="paragraph"><div class="title">Additional Features</div><p>A special <em>info</em> comment can be included anywhere in an NGCGUI-compatible subfile. The format is:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.9
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">(info: info_text)</span></span></tt></pre></div></div>
<div class="paragraph"><p>The info_text is displayed near the top of the NGCGUI tab page in AXIS.</p></div>
<div class="paragraph"><p>Files not intended for use as subfiles can include a special comment so that NGCGUI will reject them automatically with a relevant message.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.9
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">(not_a_subfile)</span></span></tt></pre></div></div>
<div class="paragraph"><p>An optional image file (.png,.gif,.jpg,.pgm) can accompany a subfile.
The image file can help clarify the parameters used by the subfile.
The image file should be in the same directory as the subfile and have the same name with an appropriate image suffix,
e.g. the subfile example.ngc could be accompanied by an image file examp.png.
NGCGUI attempts to resize large images by subsampling to a size with maximum width of 320 and maximum height of 240 pixels.</p></div>
<div class="paragraph"><p>None of the conventions required for making an NGCGUI-compatible subfile preclude its use as general purpose subroutine file for LinuxCNC.</p></div>
<div class="paragraph"><p>The LinuxCNC distribution includes a library (ngcgui_lib directory)
that includes both example NGCGUI-compatible subfiles and utility files to illustrate the features of LinuxCNC subroutines and NGCGUI usage.
Another library (gcmc_lib) provides examples for subroutine files for the G-code meta compiler (gcmc).</p></div>
<div class="paragraph"><p>Additional user sumitted subroutines can be found on the Forum in the Subroutines Section.</p></div>
</div>
<div class="sect2">
<h3 id="_gcode_meta_compiler_gcmc_file_requirements">6.2. Gcode-meta-compiler (.gcmc) file requirements</h3>
<div class="paragraph"><p>Files for the Gcode-meta-compiler (gcmc) are read by NGCGUI and it creates entry boxes for variables tagged in the file.
When a feature for the file is finalized, NGCGUI passes the file as input to the gcmc compiler and, if the compile is successful,
the resulting G-code file is sent to LinuxCNC for execution.
The resulting file is formatted as single-file subroutine; .gcmc files and .ngc files can be intermixed by NGCGUI.</p></div>
<div class="paragraph"><p>The variables identified for  inclusion in NGCGUI are tagged with lines that will appear as comments to the gcmc compiler.</p></div>
<div class="listingblock">
<div class="title">Variable Tags Formats</div>
<div class="content">
<pre><code>//ngcgui: varname1 =
//ngcgui: varname2 = value2
//ngcgui: varname3 = value3, label3;</code></pre>
</div></div>
<div class="listingblock">
<div class="title">Variable Tags Examples</div>
<div class="content">
<pre><code>//ngcgui: zsafe =
//ngcgui: feedrate = 10
//ngcgui: xl = 0, x limit</code></pre>
</div></div>
<div class="paragraph"><p>For these examples, the entry box for varname1 will have no default, the entry box for varname2 will have a default of value2,
and the entry box for varname 3 will have a default of value 3 and a label label3 (instead of varname3).
The default values must be numbers.</p></div>
<div class="paragraph"><p>To make it easier to modify valid lines in a gcmc file, alternate tag line formats accepted.
The alternate formats ignore trailing semicolons (;) and trailing comment markers (//).
With this provision, it is often makes it possible to just add the //ngcgui: tag to existing lines in a .gcmc file.</p></div>
<div class="listingblock">
<div class="title">Alternate Variable Tags Formats</div>
<div class="content">
<pre><code>//ngcgui: varname2 = value2;
//ngcgui: varname3 = value3; //, label3;</code></pre>
</div></div>
<div class="listingblock">
<div class="title">Alternate Variable Tags Examples</div>
<div class="content">
<pre><code>//ngcgui: feedrate = 10;
//ngcgui: xl = 0; //, x limit</code></pre>
</div></div>
<div class="paragraph"><p>An info line that will appear at the top of a tab page may be optionally included with a line tagged as:</p></div>
<div class="listingblock">
<div class="title">Info tag</div>
<div class="content">
<pre><code>//ngcgui: info: text_to_appear_at_top_of_tab_page</code></pre>
</div></div>
<div class="paragraph"><p>When required, options can be passed to the gcmc compiler with a line tagged:</p></div>
<div class="listingblock">
<div class="title">Option line tag format</div>
<div class="content">
<pre><code>//ngcgui: -option_name [ [=] option_value]</code></pre>
</div></div>
<div class="listingblock">
<div class="title">Option line tag Examples</div>
<div class="content">
<pre><code>//ngcgui: -I
//ngcgui: --imperial
//ngcgui: --precision 5
//ngcgui: --precision=6</code></pre>
</div></div>
<div class="paragraph"><p>Options for gcmc are available with the terminal command:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>gcmc --help</code></pre>
</div></div>
<div class="paragraph"><p>A gcmc program by default uses metric mode.
The mode can be set to inches with the option setting:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>//ngcgui: --imperial</code></pre>
</div></div>
<div class="paragraph"><p>A preamble file, if used, can set a mode (g20 or g21) that conflicts with the mode used by a gcmc file.
To ensure that the gcmc program mode is in effect, include the following statement in the .gcmc file:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>include("ensure_mode.gcmc")</code></pre>
</div></div>
<div class="paragraph"><p>and provide a proper path for gcmc include_files in the INI file, for example:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.9
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #000000">[DISPLAY]</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">GCMC_INCLUDE_PATH </span></span><span style="font-weight: bold"><span style="color: #000000">=</span></span><span style="color: #009900"> ../../nc_files/gcmc_lib</span></tt></pre></div></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_db25_example">7. DB25 Example</h2>
<div class="sectionbody">
<div class="paragraph"><p>The following shows the DB25 subroutine.
In the first photo you see where you fill in the blanks for each variable.</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<figure>
<img src="images/ngcgui-db25-1.png" alt="images/ngcgui-db25-1.png"/>
</figure>
</div>
</div>
<div class="paragraph"><p>This photo shows the backplot of the DB25 subroutine.</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<figure>
<img src="images/ngcgui-db25-2.png" alt="images/ngcgui-db25-2.png"/>
</figure>
</div>
</div>
<div class="paragraph"><p>This photo shows the use of the new button and the custom tab to create three DB25 cutouts in one program.</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<figure>
<img src="images/ngcgui-db25-3.png" alt="images/ngcgui-db25-3.png"/>
</figure>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_a_subroutine">8. Creating a subroutine</h2>
<div class="sectionbody">
<div class="ulist"><ul>
<li>
<p>
For creating a subroutine for use with NGCGUI, the filename and the subroutine name must be the same.
</p>
</li>
<li>
<p>
The file must be placed in the subdirectory pointed to in the INI file.
</p>
</li>
<li>
<p>
On the first line there may be a comment of type <code>info:</code>
</p>
</li>
<li>
<p>
The subroutine must be surrounded by the <code>sub</code> and <code>endsub</code> tags.
</p>
</li>
<li>
<p>
The variables used must be numbered variables and must not skip number.
</p>
</li>
<li>
<p>
Comments and presets may be included.
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="title">Subroutine Skeleton Example</div>
<div class="content">
<pre><code>(info: simp -- simple exemple de sous-programme -- Ctrl-U pour diter)
o&lt;simp&gt; sub
  #&lt;ra&gt;       = #1 (=.6 Rayon A) ;Example de paramtre avec un commentaire
  #&lt;radius_b&gt; = #2 (=0.4)         ;Example de paramtre sans commentaire
  #&lt;feedrate&gt; = #3 (Feedrate)     ;Example de paramtre sans preset
  g0x0y0z1
  g3 i#&lt;ra&gt; f#&lt;feedrate&gt;
  g3 i[0-#&lt;radius_b&gt;]
o&lt;simp&gt; endsub</code></pre>
</div></div>
<p><span class="comment"> vim: set syntax=asciidoc:</span></p>
</div>
</div>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
Last updated
 2023-06-18 10:43:37 CEST
</div>
</div>
</body>
</html>
